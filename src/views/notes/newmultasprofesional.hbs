<script>
    function ffechaactual() {
        var tipo = document.getElementById('fecha');
        var eye = document.getElementById('botonfecha');
        if (tipo.type == "date") {
            tipo.type = "date";
            eye.class = "btn btn-primary"
            const fecha = new Date();
            const dia = fecha.getDate();
            var mes = 0
            const calcmes = fecha.getMonth() + 1
            if (calcmes < 10) {
                mes = "0" + calcmes + "-"
            } else {
                mes = calcmes + "-"
            }
            if (dia > 0 && dia < 10) {
                var diastring = "0" + dia
            } else {
                var diastring = dia
            }
            const ano = fecha.getFullYear() + "-"
            const fullyear = ano + mes + diastring
            tipo.value = fullyear;
        } else {
            //tipo.disabled = false;
            tipo.type = "date";
            eye.class = "btn btn-secondary"
        }
    }

    function fhoraactual() {
        var tipohora = document.getElementById('horaingreso');
        var eyehora = document.getElementById('botonhora');
        if (tipohora.type == "time") {
            //tipohora.disabled = true;
            tipohora.type = "text";
            eyehora.class = "btn btn-primary"
            const fecha = new Date();
            const h = fecha.getHours() + ":";
            if (m < 10) {
                const m = "0" + fecha.getMinutes();
            } else {
                const m = fecha.getMinutes();
            }
            //s = today.getSeconds();
            const fullhora = h + m // + s
            //const fullyear = fecha.toLocaleDateString();
            horaingreso.value = fullhora;
        } else {
            //tipohora.disabled = false;
            tipohora.type = "time";
            horaingreso.value = "--:--"
            eyehora.class = "btn btn-secondary"
        }
    }

    function selectapercibimiento() {
        var selectsancion = document.getElementById("apercibimientoprof")               
        var grabar = document.getElementById("selectgrabar")  
        var SiNosancionado = document.getElementById("sancionado")      
    if (selectsancion.selectedIndex == 0) { 
        SiNosancionado.value = "SinSancion"       
        grabar.style.display = "none"   
    } else {
        SiNosancionado.value = "Sancionado"       
        grabar.style.display = "block"
    }
    }
    function clickselectreiteracion() {
        var selreiteracion = document.getElementById("selectreiteracion")
        var reiteracion = document.getElementById("reiteracion")
        if (selreiteracion.selectedIndex == 0) {
            reiteracion.disabled = true;
            reiteracion.value = ""
            reiteracion.style.display = "none"; 
        } else if (selreiteracion.selectedIndex == 1 || selreiteracion.selectedIndex == 2 || selreiteracion.selectedIndex == 3 || selreiteracion.selectedIndex == 4 || selreiteracion.selectedIndex == 5) {
            reiteracion.disabled = true;
            reiteracion.value = "Reiteración Agregada!"; 
            reiteracion.style.display = "block";       
        }
    }
    function seleccionarinciso() {
        var seleccion = document.getElementById('incisos');
        //con o sin sansion
        var tc = parseInt({{ tasaactual.tasaconstruccion }})

    document.getElementById("volverlistado").style.visibility = "hidden";
    if ((seleccion.selectedIndex == 1)) {
        document.getElementById("acta").value = "INCISO A)";
        document.getElementById("formulamulta").value = "Apercibido";        
        document.getElementById('labelvalor1').innerHTML = '';
        document.getElementById("valor1").value = 0;
        document.getElementById("valor2").value = "0";
        document.getElementById("valor3").value = 0;  

        var idvalor1 = document.getElementById("valor1").value;
        var idvalor2 = document.getElementById("valor2").value;
        var idvalor3 = document.getElementById("valor3").value;
        var MontoTotal = parseFloat(idvalor1) * parseFloat(idvalor2) * parseFloat(idvalor3)
        var montototaldosdecimales = MontoTotal.toFixed(2)
        document.getElementById("resultado").value = montototaldosdecimales
        var observacionesmas = idvalor1 + "*" + idvalor2 + "*" + idvalor3
        document.getElementById("observacionesmas").value = observacionesmas
        document.getElementById("grabar").style.display = "block";        
        var x = document.getElementById("cardinciso");
        if (x.style.display === "none") {
            x.style.display = "block";
        } else {
            x.style.display = "none";
        }
    } else if ((seleccion.selectedIndex == 2)) {
        document.getElementById("valor1").value = 0;
        document.getElementById("valor3").value = tc;
        document.getElementById("resultado").value = "0.00"
        document.getElementById("acta").value = "INCISO A) 2)";
        document.getElementById("formulamulta").value = "SCSp x 0,15 x TC";
        document.getElementById('labelvalor1').innerHTML = 'SCSp';
        document.getElementById("valor2").value = "0.15";
        var x = document.getElementById("cardinciso");
        if (x.style.display === "none") {
            x.style.display = "block";
        } else {
            x.style.display = "none";
        }
    }
    }

    function ponermayuscula() {
        let ex = document.getElementById("expediente");
        ex.value = ex.value.toUpperCase();
        let y = document.getElementById("adrema");
        y.value = y.value.toUpperCase();
    }

    function fmontototal() {
        var selectsancion = document.getElementById("profesional")
        tcprofesional = parseInt({{ tasaactual.tasaconstruccion }})
    if (selectsancion.selectedIndex == 1) {
        var porcentaje = parseFloat(document.getElementById("porcentajeprofesional").value);
        var calculoporcentaje = tcprofesional / 100 * porcentaje
        console.log("porcentaje", porcentaje)
        console.log("calculoporcentaje", calculoporcentaje)
        document.getElementById("valor3").value = calculoporcentaje;
    } else {
        document.getElementById("valor3").value = tcprofesional
    }
    var idvalor1 = document.getElementById("valor1").value;
    var idvalor2 = document.getElementById("valor2").value;
    var idvalor3 = document.getElementById("valor3").value;
    var MontoTotal = parseFloat(idvalor1) * parseFloat(idvalor2) * parseFloat(idvalor3)
    var montototaldosdecimales = MontoTotal.toFixed(2)
    document.getElementById("resultado").value = montototaldosdecimales
    var observacionesmas = idvalor1 + "*" + idvalor2 + "*" + idvalor3
    document.getElementById("observacionesmas").value = observacionesmas
    if (MontoTotal > 0) {
        document.getElementById("grabar").style.display = "block";
    } else {
        document.getElementById("grabar").style.display = "none";
    }
    }

    function ShowName() {
        var writtenName = document.getElementById('propietario').value;
        document.getElementById('propietario').value = formatToString(writtenName);
    }
    function ShowUbic() {
        var writtenName = document.getElementById('ubicacion').value;
        document.getElementById('ubicacion').value = formatToString(writtenName);
    }

    function formatToString(writtenName) {
        var tmp = writtenName.split(" ");
        var fullName;
        tmp.forEach(element => {
            if (fullName) {
                fullName = fullName + " " + element.charAt(0).toUpperCase() + element.slice(1).toLocaleLowerCase();
            } else {
                fullName = element.charAt(0).toUpperCase() + element.slice(1).toLocaleLowerCase();
            }
        })
        return fullName;
    }
</script>

<div style="max-width: 95%" class="col-md-8 mx-auto">
    <div class="card">
        <div class="card-body">
            <form action="/notes/newmultas" method="POST">
                <div class="form-group">
                    <div class="car-header mx-auto">
                        <br />
                        <h3 style="font-weight: bold; width: auto; padding: 1px 20px; margin: 0px 0; box-sizing: border-box; 
                    ; color:rgb(24, 24, 26); font-weight: bold; border-radius: 6px;
                    text-shadow: 2px 2px 5px rgb(90, 88, 88)">
                            Acta Liquidación / Sanción Profesionales
                        </h3>

                        {{!--
                        <h4 style="color:rgb(65, 65, 124); text-decoration:underline; font-weight: bold;">
                            Se aplicarán multas
                        </h4> --}}
                    </div>
                    <br />
                    <div class="car-header mx-auto"
                        style="max-width: 95%; padding: 10px; border: 5px solid gray; margin: 0;">
                        {{!-- adrema, expediente, propietario, ubicacion --}}
                        <div>
                            <p style="font-weight: bold; width: 25%; padding: 2px 20px; margin: 0px 0; box-sizing: border-box; 
                    border: 2px solid #1ecc0e; color:rgb(24, 24, 26); font-weight: bold; border-radius: 4px;">
                                DATOS PROFESIONAL:
                            </p>
                        </div>
                        <div class="row my-3">
                            <div class="col-md-2">
                                <div class="form-outline">
                                    <label style="font-weight: bold; color:black" class="form-label"
                                        for="typeText">Expediente:</label>
                                    <input onkeyup="ponermayuscula()" style="width: 100%;padding: 12px 20px; margin: 0px 0; 
                            box-sizing: border-box; border: 3px solid #0e0d0d;" value="{{multas.expediente}}"
                                        placeholder="Exped." type="text" name="expediente" id="expediente"
                                        class="form-control" autocomplete="off" autofocus minlength="10"
                                        maxlength="40" />
                                </div>
                            </div>
                            <div class=" col-md-2">
                                <div class="form-outline">
                                    <label style="font-weight: bold; color:black" class="form-label"
                                        for="typeText">Adrema:</label>
                                    <input onkeyup="ponermayuscula()" style="width: 100%;padding: 12px 20px; margin: 0px 0; 
                                    box-sizing: border-box; border: 3px solid #0e0d0d;" placeholder="Adrema"
                                        name="adrema" type="text" id="adrema" class="form-control" autocomplete="off"
                                        value="{{multas.adrema}}" />
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-outline">
                                    <label style="font-weight: bold; color:black" class="form-label"
                                        for="typeText">Profesional:</label>
                                    <input onkeyup="ShowName();" style="color:rgb(0, 0, 0); font-weight: bold; width: 100%;padding: 12px 20px; margin: 0px 0; box-sizing: 
                                                border-box; border: 3px solid #0e0d0d;" placeholder="Nombre y Apellido"
                                        name="propietario" type="text" id="propietario" class="form-control"
                                        autocomplete="off" required value="{{multas.propietario}}" />
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-outline">
                                    <label style="font-weight: bold; color:black" class="form-label"
                                        for="typeText">Ubicación:</label>
                                    <input onkeyup="ShowUbic();" style="width: 90%;padding: 12px 20px; margin: 0px 0; box-sizing: 
                                                border-box; border: 3px solid #0e0d0d;" placeholder="Ubicación"
                                        name="ubicacion" type="text" id="ubicacion" class="form-control"
                                        autocomplete="off" required maxlength="40" value="{{multas.ubicacion}}" />

                                </div>
                            </div>
                        </div>
                        <label style="font-weight: bold; color:black" for="incisos">Selecciones tipo
                            infración:</label>
                        <select name="infraccionoparalizacion" id="infraccionoparalizacion">
                            <option value="Infracción">Infracción</option>
                            <option value="Infracción/Paralización">Infracción/Paralización</option>
                        </select>
                        <br />
                        <label style="font-weight: bold; color:black" for="incisos">Selecciones un Inciso:</label>
                        <select name="inciso" id="incisos" onclick="seleccionarinciso()">
                            <option value="">Selecciones Inciso</option>
                            <option value="A">a) Apercibimiento</option>

                        </select>
                        <a id="volverlistado" href="/multas/impresasprofesional"
                            class="btn btn-outline-warning btn-block btn-sm">Volver Listado Liq.  a Profesionales</a>
                    </div>
                    <br />
                    {{!-- INCISOS --}}
                    <div id="cardinciso" class="card-body mx-auto"
                        style="display:none; max-width: 95%; padding: 10px; border: 5px solid gray; margin: 0;">

                        <label style="font-weight: bold;text-shadow: 2px 2px 5px rgb(134, 133, 133)">INFRACCIÓN Y
                            PARALIZACIÓN</label>
                        <br />
                        <input name="acta" id="acta" style="font-weight: bold; width: 21%; padding: 1px 20px; margin: 0px 0; box-sizing: border-box; 
                                border: 2px solid #cc0e0e; color:rgb(24, 24, 26); border-radius: 4px;"
                            value="INCISO A)" readonly>
                        <input name="formulamulta" id="formulamulta" style="color:blue;font-weight: bold; display:none;"
                            value="" readonly>

                        <div class="col-md-3">
                            <div class="form-outline">
                                <label style="font-weight: bold; color:black" class="form-label" for="typeText">
                                    Fecha:
                                </label>
                                <div class="input-group-append">
                                    <input style="width: 90%;padding: 12px 20px; margin: 0px 0; box-sizing: 
                            border-box; border: 3px solid #0e0d0d;" placeholder="fecha" type="date" id="fecha"
                                        name="fecha" class="form-control" autocomplete="off" required>
                                    <label style="color:white">_</label>
                                    <button id="botonfecha" class='btn btn-primary' name="botonfecha" type="button"
                                        onclick="ffechaactual()">
                                        <span class="fa fa-calendar icon"></span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-outline">
                                <label style="font-weight: bold; color:black" class="form-label" for="typeText">
                                    N° Acta:
                                </label>
                                <input style="width: 90%;padding: 12px 20px; margin: 0px 0; box-sizing: 
                            border-box; border: 3px solid #0e0d0d;" placeholder="numacta" type="text" id="idnumacta"
                                    name="numacta" class="form-control" autocomplete="off" required>
                            </div>
                            {{!-- SANCION PROFESIONALES --}}
                            <label style="font-weight: bold; color:rgb(0, 0, 0)" for="incisos">- Apercibimiento Profesional:</label>
                            <br/>
                            <select name="apercibimientoprofesional" id="apercibimientoprof" onclick="selectapercibimiento()">
                                <option value="No">No</option>                                
                                <option value="Si">Si</option>
                            </select>
                            <br/>      
                            <input style="color: red; width:200px; display:none;" id="sancionado" name="sancionprof" disabled/>
                            {{!-- REITERACIONES --}}
                            <label style="font-weight: bold; color:rgb(5, 5, 5)" for="incisos">- Reiteraciones:</label>
                            <br/>
                            <select name="reiteracion" id="selectreiteracion" onclick="clickselectreiteracion()">
                                <option value="">Sin Reiteración</option>
                                <option value="1° Reiteración">1°</option>
                                <option value="2° Reiteración">2°</option>
                                <option value="3° Reiteración">3°</option>
                                <option value="4° Reiteración">4°</option>
                                <option value="+4° Reiteración">5°/más</option>                                
                            </select>
                            <br/>
                            <input type="text" style="color: green; width:200px; display:none;" name="reiteracion" id="reiteracion" disabled/>                                                           
                        </div>
                        <div class="row my-2">
                            <div class="col-md-1">
                                <div class="form-outline">
                                    <label id="labelvalor1" style="display:none;color:blue;font-weight: bold;" class=""
                                        for="typeText">SCSp</label>
                                    <input name="scsp" onkeyup="fmontototal()" style="display:none;font-weight: bold; color:rgb(236, 10, 10)"
                                        type="number" min="0" id="valor1" value="0">
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="form-outline">
                                    <label id="labelvalor1a" style="display:none;color:blue; font-weight: bold;" class=""
                                        for="typeText">
                                        *
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-outline">
                                    <label style="display:none;color:blue;font-weight: bold;" class="form-label" for="typeText">
                                        Valor
                                    </label>
                                    <input onkeyup="fmontototal()" style="display:none;font-weight: bold; color:black" type="number"
                                        value="0.15" step="0.01" min="0" id="valor2">
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="form-outline">
                                    <label style="display:none;color:blue; font-weight: bold;" class="" for="typeText">
                                        *
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-outline">
                                    <label style="display:none;color:blue; font-weight: bold;" class="form-label"
                                        for="typeText">T.C.</label>
                                    <input name="tcactual" onkeyup="fmontototal()" placeholder="Cargue Valor"
                                        style="display:none;font-weight: bold; color:black" type="number" step="1" min="0"
                                        id="valor3">
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="form-outline">
                                    <label style="display:none;color:blue; font-weight: bold;" class="">
                                        =
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-outline">
                                    <label style="display:none;color:blue; font-weight: bold;" class="form-label" for="typeText">
                                        Monto Total
                                    </label>
                                    <input type="text" name="montototal" id="resultado" style="display:none;color:red; 
                                    width: 105%;padding: 1px 20px; margin: 0px 0; box-sizing: 
                                    border-box; border: 2px solid #000000;" placeholder="0.00">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-outline">
                                    <input type="text" value="observaciones" name="observaciones" id="observacionesmas"
                                        style="display: none;">
                                </div>
                            </div>
                        </div>
                        {{!-- ACÁ SE GRABA EL FORMULARIO --}}
                        <div id="grabar" class="mx-auto">
                            <button id="selectgrabar" class="btn btn-success btn-block" type="submit" style="display: none;">
                                Grabar
                            </button>
                        </div>
                        <p></p>
                        <a href="/multas/impresasprofesional" class="btn btn-danger btn-block btn-sm">Volver Listado Liq. a Profesionales</a>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>